虚拟化技术：
>人们为了提高系统及硬件资源的利用率而引入了虚拟化技术。虚拟化是一种资源管理技术，它可以各种实体资源【如：服务器、网络、内存及存储等】抽像后再分隔，从而打破实体结构的不可切割限制，最大程度的提高资源的利用率。

>虚拟化的目的是为了在同一个主机上运行多个系统或应用，从而提高系统资源的利用率，并带来降低成本、方便管理和容错容灾等好处。


### 虚拟化技术分类

从实现形式来分，虚拟化技术分为 `硬件虚拟化技术` 和 `软件虚拟化技术` 。而Docker属于软件虚拟化技术中的 `操作系统层虚拟化技术` ，它是基于 `LXC` 实现的一个`应用容器引擎`，Docker让开发者可以打包他们的应用及依赖环境到一个可移植的容器中，然后可以将这个容器快速部署开发、测试或生产环境中。

#### 硬件虚拟化

硬件虚拟化就是硬件物理平台本身提供了对特殊指令的截获和重定向的支持。支持虚拟化的硬件，也是一些基于硬件实现软件虚拟化技术的关键。在基于硬件实现软件虚拟化的技术中，在硬件是实现虚拟化的基础，硬件(主要是CPU)会为虚拟化软件提供支持，从而实现硬件资源的虚拟化。

支持虚拟化的硬件有：

+ `Intel-VT-(Intel Virtualization Technology)`，Intel公司为解决纯软件虚拟化解决方案在可靠性、安全性和性能上的不足而引进的技术。它可以让一个CPU工作起来像多个CPU在并行运行，从而使得在一部电脑内同时运行多个操作系统成为可能

+ `AMD-V-(AMD Virtualization)`，是AMD公司的虚拟化技术。它是对x86处理器系统架构的一组硬件扩展和硬件辅助虚拟化技术，可以简化纯软件的虚拟化解决方案，改进VMM（虚拟机监视器）的设计，更充分地利用硬件资源，提高服务器和数据中心的虚拟化效率


#### 软件虚拟化

软件虚拟化就是利用软件技术，在现有的物理平台上实现对物理平台访问的截获和模拟。在软件虚拟化技术中，有些技术不需要硬件支持，如：QEMU；而有些软件虚拟化技术，则依赖硬件支持，如：VMware、KVM。



> **Docker 的容器利用了 LXC，管理利用了 namespaces 来做权限的控制和隔离， cgroups 来进行资源的配置，并且还通过 aufs 来进一步提高文件系统的资源利用率。**

 虚拟机在底层模拟出各种硬件, cpu, 硬盘之类的, 而 docker 是在软件层面给资源分组, docker 性能无限接近原生, 因为 docker 用的就是系统自己的进程, 而虚拟机做的再好, 也做不出原生的感觉


 cgroup 有限制使用资源的能力

 blkio – 这个子系统为块设备设定输入/输出限制，比如物理设备（磁盘，固态硬盘，USB 等等）

 cpu – 这个子系统使用调度程序提供对 CPU 的 cgroup 任务访问

 cpuacct – 这个子系统自动生成 cgroup 中任务所使用的 CPU 报告

 cpuset – 这个子系统为 cgroup 中的任务分配独立 CPU（在多核系统）和内存节点

 devices – 这个子系统可允许或者拒绝 cgroup 中的任务访问设备

 freezer – 这个子系统挂起或者恢复 cgroup 中的任务

 memory – 这个子系统设定 cgroup 中任务使用的内存限制，并自动生成由那些任务使用的内存资源报告

 net_cls – 这个子系统使用等级识别符（classid）标记网络数据包，可允许 Linux 流量控制程序（tc）识别从具体 cgroup 中生成的数据包

 ns – 名称空间子系统



### Docker的构成

Docker使用客户端-服务器 (C/S) 架构模式 使用远程API来管理和创建Docker容器。Docker 容器（Container）通过 Docker 镜像（Image）来创建，二者之间的关系类似于面向对象编程中的对象与类。


Docker客户端用于向Docker服务器或守护进程发送请求。而服务器或守护进程会接受来自客户的请求（创建、运行、分发容器），并在处理完请求后返回响应结果。Docker提供了一个命令行工具docker，及一整套RESTful API。客户端和服务端既可以运行在一个机器上，也可通过 socket或者RESTful API来进行通信。


Docker也并不是万能的，其设计目的也并不是要成为KVM等的替代品。不可避免的，Docker也会有一些局限性，如：

基于Linux内核，所以只能运行于Linux环境中，且只能64位主机上
基于LXC实现的容器，而LXC是基于Linux内核中的cgroup。因此，Docker容器使用的权限、物理资源等也受限于LXC




docker相对于全虚拟化和半虚拟化而言，是所谓的操作系统级别的轻量级虚拟化技术。传统的虚拟化技术要生成一个环境的时间非常久，对于docker来说启动和销毁都是秒级的，而且它底层依赖的技术lxc(linux container)完全是内核特性，没有任何中间层开销，对于资源的利用率极高性能接近物理机。当然由于现在docker依赖于lxc，所以你只能在Linux上跑它（现在mac osx也支持，但是也只是用了virtualbox搞了个linux虚拟机啊罢了，


docker做到了PAAS即平台即服务，docker在64位linux上使用的是lxc内核虚拟化也就是轻量级的虚拟化，与VM相比不需要对硬件进行仿真就可以共享跟主机一样的操作系统，并且有AUFS和lXC来虚拟化，加入一个ubuntu的镜像是265MB，你要再VM主机新建1000个就需要265000MB内存，但是docker共享容量也就需需要256多一点，如果你在linux上跑VMware相信你会看主机内存的消耗是比较大的，一个亚马逊EC2 512MB内存单核的云主机开5个docker无压力，你要是跑5个vmware那可费劲了


>**Docker 是基于 LXC 的，它属于进程级的虚拟化方案，从宿主的机器看，每个运行的 Docker 都是一个进程。
Xen/OpenVZ 这类是系统级的虚拟化方案。从宿主的机器看，允许都是一个一个虚拟机。**
